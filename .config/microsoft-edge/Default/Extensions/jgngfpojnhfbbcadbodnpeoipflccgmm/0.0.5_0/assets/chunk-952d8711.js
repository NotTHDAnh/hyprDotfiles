chrome.webRequest.onSendHeaders.addListener(d=>{var a,t;const{requestHeaders:n=[],url:i,tabId:c}=d,o=(a=n.find)==null?void 0:a.call(n,r=>r.name==="Referer"),{value:u=""}=o||{},{searchParams:l}=new URL(i),s=((t=l.get("peerSubmissionId"))==null?void 0:t.split("~")[2])||"",e=u.replace(/\/submit$/,"/review");if(i.includes("onDemandPeer")&&s&&e){let r="";switch(!0){case(!e.endsWith(s)&&e.endsWith("/review")):r=`${e}/${s}`;break;case(!e.includes(s)&&!e.includes("/review")):r=`${e}/review/${s}`;break}const b={Link:r||e};chrome.tabs.sendMessage(c,b)}},{urls:["<all_urls>"]},["requestHeaders","extraHeaders"]);
