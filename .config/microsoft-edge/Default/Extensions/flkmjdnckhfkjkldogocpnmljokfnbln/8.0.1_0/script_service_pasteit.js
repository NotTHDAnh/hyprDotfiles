const keys={0:"pasteText",1:"altText",2:"altText2",3:"altText3",4:"altText4",5:"altText5",6:"altText6",7:"altText7",8:"altText8",9:"altText9",10:"altText10",11:"altText11",12:"altText12",13:"altText13",14:"altText14",15:"altText15"},keyArray=Object.values(keys),commands={0:"keyboard-paste",1:"pa-keyboard-paste",2:"pb-keyboard-paste2",3:"pc-keyboard-paste3",4:"pd-keyboard-paste4",5:"pe-keyboard-paste5",6:"pf-keyboard-paste6",7:"pg-keyboard-paste7",8:"ph-keyboard-paste8",9:"pi-keyboard-paste9",10:"pj-keyboard-paste10",11:"pk-keyboard-paste11",12:"pl-keyboard-paste12",13:"pm-keyboard-paste13",14:"pn-keyboard-paste14",15:"po-keyboard-paste15"},commandsArray=Object.values(commands);function injectScript(e,t=(()=>{}),a){chrome.storage.sync.get([e],(o=>{const s=o[e];s?chrome.windows.getCurrent((e=>{chrome.tabs.query({active:!0,windowId:e.id},(e=>{e[0]?chrome.scripting.executeScript({target:{tabId:e[0].id,allFrames:!1},files:["script_inject_pasteit.js"]},(o=>{chrome.runtime.lastError?a?a(o,s):e[0].url.includes("options.html")||chrome.tabs.create({url:"options.html#fromPaste"}):t(e[0].id,s)})):t(null,s)}))})):chrome.tabs.create({url:"options.html"})}))}chrome.commands.onCommand.addListener((e=>{chrome.storage.sync.get(["keyboardDisabled"],(t=>{if("true"!==t.keyboardDisabled){const t=commandsArray.indexOf(e);injectScript(keys[t],((e,t)=>{pasteIt(e,t)}))}}))})),chrome.storage.onChanged.addListener((e=>{let t=!1;for(const a in e)e[a].newValue!==e[a].oldValue&&(t=!0);t&&updateMenu()})),chrome.contextMenus.onClicked.addListener((({menuItemId:e})=>{injectScript(e,((e,t)=>{pasteIt(e,t)}))}));const injectPasteit=()=>{injectScript("pasteText",((e,t)=>{pasteIt(e,t)}))},updateMenu=()=>{chrome.storage.sync.get(["contextFlyout","contextDisabled","popupDisabled"],(({contextDisabled:e,contextFlyout:t,popupDisabled:a})=>{let o;a?(chrome.action.setPopup({popup:""}),chrome.action.onClicked.addListener(injectPasteit)):(chrome.action.setPopup({popup:"action.html"}),chrome.action.onClicked.removeListener(injectPasteit)),o="false"===t?.toString()?["pasteText"]:keyArray,chrome.storage.sync.get(o,(t=>{chrome.contextMenus.removeAll((()=>{if("true"!==e?.toString()){t.pasteText||chrome.contextMenus.create({id:"pasteText",title:"Set Paste Text",contexts:["editable"]});for(let e of o)t[e]&&chrome.contextMenus.create({id:e,title:t[e],contexts:["editable"]})}}))}))}))};function pasteIt(e,t,a=!1,o=(()=>{})){const s={};null!=t&&""!=t&&(s.status=t),chrome.tabs.sendMessage(e,{sendOrigin:"pasteIt",getTextResponse:s,fromPopup:a},{},o)}updateMenu(),chrome.runtime.onMessage.addListener(((e,t,a)=>{if(e.pasteFromPopup){const t=commandsArray.indexOf(e.pasteFromPopup);injectScript(keys[t],((e,t)=>{pasteIt(e,t,!0,a)}),((e,t)=>{a({error:e,text:t})}))}return!0}));