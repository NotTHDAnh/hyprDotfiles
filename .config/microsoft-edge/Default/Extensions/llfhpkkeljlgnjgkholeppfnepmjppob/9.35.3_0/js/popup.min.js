ZaDarkBrowser.initClassNames(),ZaDarkUtils.initOSName(),ZaDarkUtils.initTippy(),ZaDarkUtils.installFontFamily(["Open Sans:400;500;600"]);const MSG_ACTIONS=ZaDarkUtils.MSG_ACTIONS,ratingElName="#js-ext-rating",btnScrollElName="#js-btn-scroll",radioInputThemeElName='#js-radio-input-theme input:radio[name="theme"]',inputFontFamilyElName="#js-input-font-family",selectFontSizeElName="#js-select-font-size",selectTranslateTargetElName="#js-select-translate-target",switchHideLatestMessageElName="#js-switch-hide-latest-message",switchHideConvAvatarElName="#js-switch-hide-conv-avatar",switchHideConvNameElName="#js-switch-hide-conv-name",switchHideThreadChatMessageElName="#js-switch-hide-thread-chat-message",switchBlockTypingElName="#js-switch-block-typing",switchBlockSeenElName="#js-switch-block-seen",switchBlockDeliveredElName="#js-switch-block-delivered",switchUseHotkeysElName="#js-switch-use-hotkeys";$(ratingElName).attr("href",ZaDarkUtils.getRatingURL(ZaDarkBrowser.name)),ZaDarkBrowser.getExtensionSettings().then(({theme:e,fontFamily:a,fontSize:s,translateTarget:t,enabledHideLatestMessage:l,enabledHideConvAvatar:n,enabledHideConvName:c,enabledHideThreadChatMessage:i,useHotkeys:o})=>{ZaDarkUtils.setPageTheme(e),ZaDarkUtils.setUseHotkeysAttr(o),$(radioInputThemeElName).filter(`[value="${e}"]`).attr("checked",!0),$(inputFontFamilyElName).val(a).blur(),$(selectFontSizeElName).val(s),$(selectTranslateTargetElName).setLanguagesOptions(t),$(switchHideLatestMessageElName).prop("checked",l),$(switchHideConvAvatarElName).prop("checked",n),$(switchHideConvNameElName).prop("checked",c),$(switchHideThreadChatMessageElName).prop("checked",i),$(switchUseHotkeysElName).prop("checked",o)}),$(radioInputThemeElName).on("change",async function(){const e=$(this).val();ZaDarkUtils.setPageTheme(e),ZaDarkBrowser.sendMessage2ZaloTabs(MSG_ACTIONS.CHANGE_THEME,{theme:e})}),$(inputFontFamilyElName).keypress(async function(e){if(!(Number(e.keyCode?e.keyCode:e.which)-1==12))return;const a=$(this).val();await ZaDarkUtils.updateFontFamily(a)?ZaDarkBrowser.sendMessage2ZaloTabs(MSG_ACTIONS.REFRESH_ZALO_TABS):$(this).val("")}),$(selectFontSizeElName).on("change",async function(){const e=$(this).val();ZaDarkBrowser.sendMessage2ZaloTabs(MSG_ACTIONS.CHANGE_FONT_SIZE,{fontSize:e})}),$(selectTranslateTargetElName).on("change",async function(){const e=$(this).val();ZaDarkBrowser.sendMessage2ZaloTabs(MSG_ACTIONS.CHANGE_TRANSLATE_TARGET,{translateTarget:e})}),$(switchHideLatestMessageElName).on("change",async function(){const e=$(this).is(":checked");ZaDarkBrowser.sendMessage2ZaloTabs(MSG_ACTIONS.CHANGE_HIDE_LATEST_MESSAGE,{isEnabled:e})}),$(switchHideConvAvatarElName).on("change",async function(){const e=$(this).is(":checked");ZaDarkBrowser.sendMessage2ZaloTabs(MSG_ACTIONS.CHANGE_HIDE_CONV_AVATAR,{isEnabled:e})}),$(switchHideConvNameElName).on("change",async function(){const e=$(this).is(":checked");ZaDarkBrowser.sendMessage2ZaloTabs(MSG_ACTIONS.CHANGE_HIDE_CONV_NAME,{isEnabled:e})}),$(switchHideThreadChatMessageElName).on("change",async function(){const e=$(this).is(":checked");ZaDarkBrowser.sendMessage2ZaloTabs(MSG_ACTIONS.CHANGE_HIDE_THREAD_CHAT_MESSAGE,{isEnabled:e})}),$(switchUseHotkeysElName).on("change",async function(){const e=$(this).is(":checked");ZaDarkBrowser.sendMessage2ZaloTabs(MSG_ACTIONS.CHANGE_USE_HOTKEYS,{isEnabled:e})});const handleBlockingRuleChange=(e,a)=>()=>{const s=$(e).is(":checked")?{enableRulesetIds:[a]}:{disableRulesetIds:[a]};ZaDarkBrowser.sendMessage({action:MSG_ACTIONS.UPDATE_ENABLED_BLOCKING_RULE_IDS,payload:s})},loadBlocking=()=>{if(ZaDarkUtils.isSupportDeclarativeNetRequest())ZaDarkBrowser.sendMessage({action:MSG_ACTIONS.GET_ENABLED_BLOCKING_RULE_IDS}).then(e=>{Array.isArray(e)&&($(switchBlockTypingElName).prop("checked",e.includes("rules_block_typing")),$(switchBlockSeenElName).prop("checked",e.includes("rules_block_seen")),$(switchBlockDeliveredElName).prop("checked",e.includes("rules_block_delivered")))}),$(switchBlockTypingElName).on("change",handleBlockingRuleChange(switchBlockTypingElName,"rules_block_typing")),$(switchBlockSeenElName).on("change",handleBlockingRuleChange(switchBlockSeenElName,"rules_block_seen")),$(switchBlockDeliveredElName).on("change",handleBlockingRuleChange(switchBlockDeliveredElName,"rules_block_delivered"));else{[switchBlockTypingElName,switchBlockSeenElName,switchBlockDeliveredElName].forEach(e=>{$(e).parent().parent().addClass("zadark-switch--disabled")})}};loadBlocking(),$(btnScrollElName).on("click",()=>{window.scrollTo({left:0,top:document.body.scrollHeight,behavior:"smooth"})});const calcPopupScroll=()=>{const e=$(window).scrollTop();!($(window).height()<$(document).height())||e>=24?$(btnScrollElName).fadeOut(150):$(btnScrollElName).fadeIn(150)};calcPopupScroll(),$(window).on("scroll",ZaDarkShared.debounce(calcPopupScroll,150));