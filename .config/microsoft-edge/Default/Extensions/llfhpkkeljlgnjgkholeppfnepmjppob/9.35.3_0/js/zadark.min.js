!function(){ZaDarkBrowser.initClassNames(),ZaDarkUtils.initPageSettings(),document.documentElement.setAttribute("data-zadark-emoji-url",ZaDarkBrowser.getURL("/images/zalo-emoji-md.png"));const a=a=>{["light","dark","auto"].forEach(n=>{$('#js-radio-input-theme input:radio[name="theme"]').filter(`[value="${n}"]`).prop("checked",n===a)})},n=(a,n)=>{$(a).val(n)},s=(a,n)=>{$(a).prop("checked",n)};async function e(a){if(!(Number(a.keyCode?a.keyCode:a.which)-1==12))return;const n=$(this).val();await ZaDarkUtils.updateFontFamily(n)||$(this).val("")}const t=async a=>{const{fontSize:n}=await ZaDarkBrowser.getExtensionSettings(),s=["small","medium","big","very-big"],e=a>0?Math.min(s.indexOf(n)+1,s.length-1):Math.max(s.indexOf(n)-1,0),t=s[e];b(t)},i=a=>(function(){const n=$(this).is(":checked"),s=n?{enableRulesetIds:[a]}:{disableRulesetIds:[a]};ZaDarkBrowser.sendMessage({action:f.UPDATE_ENABLED_BLOCKING_RULE_IDS,payload:s}),ZaDarkUtils.showToast(ZaDarkUtils.HOTKEYS_TOAST_MESSAGE[a][n])});function c(){const a=$(this).is(":checked");z(a)}const l=`\n    <div id="js-zadark-popup" class="zadark-popper">\n      <div id="zadark-popup">\n        <div id="js-zadark-popup__scrollable" class="zadark-popup__scrollable">\n          ${`\n    <div class="zadark-popup__header">\n      <div class="zadark-popup__header__logo">\n        <img src="${ZaDarkBrowser.getURL("images/zadark-lockup.svg")}" alt="ZaDark" class="zadark-popup__header__logo-img" />\n      </div>\n\n      <div class="zadark-popup__header__menu-list">\n        <span class="zadark-popup__header__menu-item zadark-popup__header__menu-divider">\n          <a href="https://www.producthunt.com/products/zadark-zalo-dark-mode#zadark-zalo-dark-mode" title="Product Hunt" target="_blank">Product Hunt</a>\n        </span>\n\n        <span class="zadark-popup__header__menu-item zadark-popup__header__menu-divider">\n          <a href="https://zadark.com/blog" title="Góp ý" target="_blank">Blog</a>\n        </span>\n\n        <span class="zadark-popup__header__menu-item zadark-popup__header__menu-divider">\n          <a href="${ZaDarkUtils.getRatingURL(ZaDarkBrowser.name)}" title="Đánh giá" target="_blank">Đánh giá</a>\n        </span>\n\n        <span class="zadark-popup__header__menu-item">\n          <a href="https://zadark.canny.io" title="Góp ý" target="_blank">Góp ý</a>\n        </span>\n      </div>\n    </div>\n  `}\n          \n    <div class="zadark-popup__main">\n      <div class="zadark-panel">\n        <div class="zadark-panel__body">\n          <div id="js-radio-input-theme" class="zadark-radio__list zadark-radio__list--row">\n            <label class="zadark-radio">\n              <input type="radio" name="theme" value="light" class="zadark-radio__input">\n              <span class="zadark-radio__checkmark"></span>\n              <span class="zadark-radio__label">\n                <span>Sáng</span>\n                <span class="zadark-switch__hotkeys">\n                  &nbsp;<span class="zadark-hotkeys" data-keys-win="Ctrl+D" data-keys-mac="⌘D" data-keys-safari="⌘D"></span>\n                </span>\n              </span>\n            </label>\n\n            <label class="zadark-radio">\n              <input type="radio" name="theme" value="dark" class="zadark-radio__input">\n              <span class="zadark-radio__checkmark"></span>\n              <span class="zadark-radio__label">\n                <span>Tối</span>\n                <span class="zadark-switch__hotkeys">\n                  &nbsp;<span class="zadark-hotkeys" data-keys-win="Ctrl+D" data-keys-mac="⌘D" data-keys-safari="⌘D"></span>\n                </span>\n              </span>\n            </label>\n\n            <label class="zadark-radio">\n              <input type="radio" name="theme" value="auto" class="zadark-radio__input">\n              <span class="zadark-radio__checkmark"></span>\n              <span class="zadark-radio__label">\n                <span>Hệ thống</span>\n              </span>\n            </label>\n          </div>\n\n          <div class="font-settings">\n            <label class="font-settings__label">\n              Phông chữ từ <a href="https://zadark.com/blog/use-google-fonts" target="_blank">Google Fonts</a>\n            </label>\n\n            <input id="js-input-font-family" class="zadark-input" placeholder="Mặc định">\n          </div>\n\n          <div class="font-settings font-settings--hotkeys">\n            <label class="select-font__label">Cỡ chữ của tin nhắn</label>\n\n            <span class="font-settings__hotkeys">\n              <span class="zadark-hotkeys" data-keys-win="Ctrl+9 Ctrl+0" data-keys-mac="⌘9 ⌘0" data-keys-safari="⌃9 ⌃0"></span>\n            </span>\n\n            <select id="js-select-font-size" class="zadark-select">\n              <option value="small">90%</option>\n              <option value="medium">100%</option>\n              <option value="big">110%</option>\n              <option value="very-big">125%</option>\n            </select>\n          </div>\n\n          <div class="font-settings">\n            <label class="font-settings__label" style="flex: 1;">\n              Dịch tin nhắn\n              <i class="zadark-icon zadark-icon--question" data-tippy-content='<p>Bạn di chuyển chuột vào đoạn tin nhắn và chọn biểu tượng <i class="zadark-icon zadark-icon--translate" style="position: relative; top: 3px; font-size: 18px;"></i> để dịch tin nhắn.</p><p>Bạn có 20 lượt dịch tin nhắn mỗi ngày.</p>'></i>\n            </label>\n\n            <select id="js-select-translate-target" class="zadark-select"></select>\n          </div>\n\n          <div class="font-settings">\n            <label class="font-settings__label" style="flex: 1;">\n              Hình nền cuộc trò chuyện\n              <i class="zadark-icon zadark-icon--question" data-tippy-content='<p>Chọn một cuộc trò chuyện bất kỳ để thêm hình nền.</p><p>Hình nền được lưu trên trình duyệt của bạn, không đồng bộ với Zalo Mobile và mất khi bạn gỡ cài đặt ZaDark.</p>'></i>\n            </label>\n\n            <input type="file" id="js-input-thread-chat-bg" class="zadark-input-file" accept=".jpg, .jpeg, .png" />\n            <label for="js-input-thread-chat-bg"></label>\n\n            <button id="js-button-del-thread-chat-bg" class="btn-del" style="margin-left: 12px;">Xoá</button>\n          </div>\n        </div>\n      </div>\n\n      <div class="zadark-panel">\n        <div class="zadark-panel__body">\n          <div class="zadark-switch__list">\n            <div class="zadark-switch">\n              <label class="zadark-switch__label zadark-switch__label--helper" for="js-switch-hide-latest-message">\n                Ẩn <strong>Tin nhắn gần nhất</strong>\n                <i class="zadark-icon zadark-icon--question" data-tippy-content='Để xem nội dung tin nhắn, bạn di chuột vào<br/>"<strong>Tên cuộc trò chuyện</strong>" cần xem'></i>\n              </label>\n              <span class="zadark-switch__hotkeys">\n                <span class="zadark-hotkeys" data-keys-win="Ctrl+1" data-keys-mac="⌘1" data-keys-safari="⌃1"></span>\n              </span>\n              <label class="zadark-switch__checkbox">\n                <input class="zadark-switch__input" type="checkbox" id="js-switch-hide-latest-message">\n                <span class="zadark-switch__slider"></span>\n              </label>\n            </div>\n\n            <div class="zadark-switch zadark-switch--border-default">\n              <label class="zadark-switch__label zadark-switch__label--helper" for="js-switch-hide-thread-chat-message">\n                Ẩn <strong>Tin nhắn</strong> trong cuộc trò chuyện\n                <i class="zadark-icon zadark-icon--play-circle" data-zdk-intro="hideThreadChatMessage" data-tippy-content="Nhấn vào để xem hướng dẫn"></i>\n              </label>\n              <span class="zadark-switch__hotkeys">\n                <span class="zadark-hotkeys" data-keys-win="Ctrl+2" data-keys-mac="⌘2" data-keys-safari="⌃2"></span>\n              </span>\n              <label class="zadark-switch__checkbox">\n                <input class="zadark-switch__input" type="checkbox" id="js-switch-hide-thread-chat-message">\n                <span class="zadark-switch__slider"></span>\n              </label>\n            </div>\n\n            <div class="zadark-switch">\n              <label class="zadark-switch__label zadark-switch__label--helper" for="js-switch-hide-conv-avatar">\n                Ẩn <strong>Ảnh đại diện</strong> cuộc trò chuyện\n                <i class="zadark-icon zadark-icon--question" data-tippy-content='Để xem Ảnh đại diện, bạn di chuyển chuột vào<br/>"<strong>Ảnh đại diện</strong>" cần xem'></i>\n              </label>\n              <span class="zadark-switch__hotkeys">\n                <span class="zadark-hotkeys" data-keys-win="Ctrl+3" data-keys-mac="⌘3" data-keys-safari="⌃3"></span>\n              </span>\n              <label class="zadark-switch__checkbox">\n                <input class="zadark-switch__input" type="checkbox" id="js-switch-hide-conv-avatar">\n                <span class="zadark-switch__slider"></span>\n              </label>\n            </div>\n\n            <div class="zadark-switch zadark-switch--border-default">\n              <label class="zadark-switch__label zadark-switch__label--helper" for="js-switch-hide-conv-name">\n                Ẩn <strong>Tên</strong> cuộc trò chuyện\n                <i class="zadark-icon zadark-icon--question" data-tippy-content='Để xem Tên cuộc trò chuyện, bạn di chuyển chuột vào "<strong>Tên cuộc trò chuyện</strong>" cần xem'></i>\n              </label>\n              <span class="zadark-switch__hotkeys">\n                <span class="zadark-hotkeys" data-keys-win="Ctrl+7" data-keys-mac="⌘7" data-keys-safari="⌃7"></span>\n              </span>\n              <label class="zadark-switch__checkbox">\n                <input class="zadark-switch__input" type="checkbox" id="js-switch-hide-conv-name">\n                <span class="zadark-switch__slider"></span>\n              </label>\n            </div>\n\n            <div class="zadark-switch">\n              <label class="zadark-switch__label zadark-switch__label--helper" for="js-switch-block-typing">\n                Ẩn trạng thái <strong>Đang soạn tin</strong>\n                <i class="zadark-icon zadark-icon--question" data-tippy-content='Người khác sẽ không thấy trạng thái <strong>Đang soạn tin</strong> của bạn, nhưng bạn vẫn thấy trạng thái của họ. Đây là điểm khác biệt giữa cài đặt từ ZaDark và Zalo.'></i>\n              </label>\n              <span class="zadark-switch__hotkeys">\n                <span class="zadark-hotkeys" data-keys-win="Ctrl+4" data-keys-mac="⌘4" data-keys-safari="⌃4"></span>\n              </span>\n              <label class="zadark-switch__checkbox">\n                <input class="zadark-switch__input" type="checkbox" id="js-switch-block-typing">\n                <span class="zadark-switch__slider"></span>\n              </label>\n            </div>\n\n            <div class="zadark-switch">\n              <label class="zadark-switch__label zadark-switch__label--helper" for="js-switch-block-delivered">\n                Ẩn trạng thái <strong>Đã nhận</strong>\n                <i class="zadark-icon zadark-icon--question" data-tippy-content='Người khác sẽ không thấy trạng thái <strong>Đã nhận</strong> tin nhắn của bạn, nhưng bạn vẫn thấy trạng thái của họ. Đây là điểm khác biệt giữa cài đặt từ ZaDark và Zalo.'></i>\n              </label>\n              <span class="zadark-switch__hotkeys">\n                <span class="zadark-hotkeys" data-keys-win="Ctrl+5" data-keys-mac="⌘5" data-keys-safari="⌃5"></span>\n              </span>\n              <label class="zadark-switch__checkbox">\n                <input class="zadark-switch__input" type="checkbox" id="js-switch-block-delivered">\n                <span class="zadark-switch__slider"></span>\n              </label>\n            </div>\n\n            <div class="zadark-switch">\n              <label class="zadark-switch__label" for="js-switch-block-seen">\n                Ẩn trạng thái <strong>Đã xem</strong>\n                <i class="zadark-icon zadark-icon--question" data-tippy-content='<p>Người khác sẽ không thấy trạng thái <strong>Đã xem</strong> tin nhắn của bạn, nhưng bạn vẫn thấy trạng thái của họ. Đây là điểm khác biệt giữa cài đặt từ ZaDark và Zalo.</p><p>Tuy nhiên, trạng thái của các tin nhắn bạn đã xem trên Zalo Web sẽ <strong>không được đồng bộ</strong> với máy chủ Zalo, bạn cần phải xem lại tin nhắn trên Zalo Mobile để đồng bộ.</p>'></i>\n              </label>\n              <span class="zadark-switch__hotkeys">\n                <span class="zadark-hotkeys" data-keys-win="Ctrl+6" data-keys-mac="⌘6" data-keys-safari="⌃6"></span>\n              </span>\n              <label class="zadark-switch__checkbox">\n                <input class="zadark-switch__input" type="checkbox" id="js-switch-block-seen">\n                <span class="zadark-switch__slider"></span>\n              </label>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="zadark-panel">\n        <div class="zadark-panel__body">\n          <div class="zadark-switch__list">\n            <div class="zadark-switch">\n              <label class="zadark-switch__label zadark-switch__label--helper" for="js-switch-use-hotkeys">\n                Sử dụng phím tắt\n              </label>\n              <label class="zadark-switch__checkbox">\n                <input class="zadark-switch__input" type="checkbox" id="js-switch-use-hotkeys">\n                <span class="zadark-switch__slider"></span>\n              </label>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  \n          \n    <div class="zadark-popup__footer">\n      <a href="https://quaric.com" target="_blank" title="ZaDark by Quaric" class="zadark-publisher">\n        <span class="zadark-publisher__by">ZaDark by</span>\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 64" fill="none" class="zadark-publisher__lockup"><path fill="currentColor" fill-rule="evenodd" d="M264 64V54h-12.998A24.892 24.892 0 0 0 256 39V25c0-13.807-11.193-25-25-25h-46c-13.807 0-25 11.193-25 25v14c0 13.807 11.193 25 25 25h79Zm-79-54c-8.284 0-15 6.716-15 15v14c0 8.284 6.716 15 15 15h46.019C239.294 53.99 246 47.278 246 39V25c0-8.284-6.716-15-15-15h-46Z" clip-rule="evenodd"/><path fill="currentColor" d="M282 0v39c0 8.284 6.716 15 15 15h37V0h10v64h-47c-13.807 0-25-11.193-25-25V0h10Z"/><path fill="currentColor" fill-rule="evenodd" d="M415 0h-39v10h39c7.948 0 14.452 6.182 14.967 14H380c-11.046 0-20 8.954-20 20s8.954 20 20 20h60V25c0-13.807-11.193-25-25-25Zm-35 34h50v20h-50c-5.523 0-10-4.477-10-10s4.477-10 10-10Z" clip-rule="evenodd"/><path fill="currentColor" d="M456 25c0-13.807 11.193-25 25-25h45v10h-45c-8.284 0-15 6.716-15 15v39h-10V25ZM544 64V0h-10v64h10ZM570 25c0-8.284 6.716-15 15-15h55V0h-55c-13.807 0-25 11.193-25 25v14c0 13.807 11.193 25 25 25h55V54h-55c-8.284 0-15-6.716-15-15V25ZM72 0l44.313 15.783c15.583 5.172 15.583 27.263 0 32.434L72 64V53.338l41.161-14.66c6.416-2.13 6.416-11.226 0-13.356L78.518 12.75 56 64 11.687 48.218c-15.583-5.172-15.583-27.263 0-32.435L56 0v10.662l-41.161 14.66c-6.416 2.13-6.416 11.226 0 13.356L49.482 51.25 72 0Z"/></svg>\n      </a>\n    </div>\n  \n\n          <button id="js-btn-scroll" data-tippy-content="Cuộn xuống">\n            <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path d="M413.1 222.5l22.2 22.2c9.4 9.4 9.4 24.6 0 33.9L241 473c-9.4 9.4-24.6 9.4-33.9 0L12.7 278.6c-9.4-9.4-9.4-24.6 0-33.9l22.2-22.2c9.5-9.5 25-9.3 34.3.4L184 343.4V56c0-13.3 10.7-24 24-24h32c13.3 0 24 10.7 24 24v287.4l114.8-120.5c9.3-9.8 24.8-10 34.3-.4z" fill="currentColor" /></svg>\n          </button>\n        </div>\n      </div>\n    </div>\n  `,r=(a=!0)=>{if(!a)return void hotkeys.unbind();hotkeys.filter=function(a){const n=a.target||a.srcElement,s=n.tagName;let e=!0;return"INPUT"!==s&&"TEXTAREA"!==s&&"SELECT"!==s||n.readOnly||(e=!1),e};const n=["command+1","command+2","command+3","command+7","command+4","command+5","command+6","command+0","command+9","command+d","ctrl+1","ctrl+2","ctrl+3","ctrl+7","ctrl+4","ctrl+5","ctrl+6","ctrl+0","ctrl+9","ctrl+d"].join(",");hotkeys(n,async function(a,n){a.preventDefault();const{enabledHideLatestMessage:e,enabledHideThreadChatMessage:c,enabledHideConvAvatar:l,enabledHideConvName:r,enabledBlockTyping:d,enabledBlockSeen:o,enabledBlockDelivered:h}=await ZaDarkBrowser.getExtensionSettings();switch(n.key){case"command+1":case"ctrl+1":return void v(!e);case"command+2":case"ctrl+2":return void y(!c);case"command+3":case"ctrl+3":return void m(!l);case"command+7":case"ctrl+7":return void w(!r);case"command+4":case"ctrl+4":return s("#js-switch-block-typing",!d),void i("rules_block_typing").bind($("#js-switch-block-typing"))();case"command+5":case"ctrl+5":return s("#js-switch-block-delivered",!h),void i("rules_block_delivered").bind($("#js-switch-block-delivered"))();case"command+6":case"ctrl+6":return s("#js-switch-block-seen",!o),void i("rules_block_seen").bind($("#js-switch-block-seen"))();case"command+0":case"ctrl+0":return void t(1);case"command+9":case"ctrl+9":return void t(-1);case"command+d":case"ctrl+d":(async()=>{const{theme:a}=await ZaDarkBrowser.getExtensionSettings(),n=["light","dark"],s=n.indexOf(a)+1,e=n[s]||n[0];_(e)})()}})},d=async()=>{const{theme:e,fontFamily:t,fontSize:i,enabledHideLatestMessage:c,enabledHideConvAvatar:l,enabledHideConvName:r,enabledHideThreadChatMessage:d}=await ZaDarkBrowser.getExtensionSettings();a(e),n("#js-input-font-family",t),n("#js-select-font-size",i),s("#js-switch-hide-latest-message",c),s("#js-switch-hide-conv-avatar",l),s("#js-switch-hide-conv-name",r),s("#js-switch-hide-thread-chat-message",d),(async(a=!1)=>{if(!a)return void["#js-switch-block-typing","#js-switch-block-seen","#js-switch-block-delivered"].forEach(a=>{$(a).parent().parent().addClass("zadark-switch--disabled")});const n=await ZaDarkBrowser.sendMessage({action:f.GET_ENABLED_BLOCKING_RULE_IDS});Array.isArray(n)&&(s("#js-switch-block-typing",n.includes("rules_block_typing")),s("#js-switch-block-seen",n.includes("rules_block_seen")),s("#js-switch-block-delivered",n.includes("rules_block_delivered")))})(ZaDarkUtils.isSupportDeclarativeNetRequest())},o=()=>{const a=$("#js-zadark-popup__scrollable"),n=a.scrollTop();!(a.prop("scrollHeight")>a.innerHeight())||n>=24?$("#js-btn-scroll").fadeOut(150):$("#js-btn-scroll").fadeIn(150)},h=(a,n,s=!0)=>{s?(a.classList.add("selected"),n.setAttribute("data-visible","")):(a.classList.remove("selected"),n.removeAttribute("data-visible"))},k=(a,n)=>()=>{d(),(a=>{const n=ZaDarkBrowser.getManifest().version;ZaDarkBrowser.saveExtensionSettings({knownVersion:n}),a.classList.remove("zadark-known-version")})(a),h(a,n,!0),o()},p=()=>{const[a]=document.querySelectorAll(".nav__tabs__bottom");if(!a)return;a.insertAdjacentHTML("afterbegin",'\n    <div id="div_Main_TabZaDark" class="clickable leftbar-tab flx flx-col flx-al-c flx-center rel" data-id="div_Main_TabZaDark">\n      <i class="zadark-icon zadark-icon--zadark"></i>\n      <div class="lb-tab-title truncate">ZaDark</div>\n    </div>\n  '),document.body.insertAdjacentHTML("beforeend",l),$('#js-radio-input-theme input:radio[name="theme"]').on("change",function(){const a=$(this).val();_(a)}),$("#js-input-font-family").keypress(e),$("#js-select-font-size").on("change",function(){const a=$(this).val();b(a)}),$("#js-select-translate-target").on("change",function(){const a=$(this).val();g(a)}),$("#js-input-thread-chat-bg").on("click",function(a){ZaDarkUtils.getCurrentConvId()||(a.preventDefault(),ZaDarkUtils.showToast("Chọn một cuộc trò chuyện để đặt hình nền"))}),$("#js-input-thread-chat-bg").on("change",function(){const a=this.files[0];a&&(a.size>4194304?ZaDarkUtils.showToast("Dung lượng ảnh tối đa là 4MB",{className:"toastify--error",duration:3e3}):ZaDarkShared.convertImageToBase64(a).then(a=>{ZaDarkUtils.updateThreadChatBg(a),$(this).addClass("zadark-input-file--loaded")}).catch(a=>{ZaDarkUtils.showToast(`Lỗi khi tải ảnh: ${a.message}`)}))}),$("#js-button-del-thread-chat-bg").on("click",function(){ZaDarkUtils.updateThreadChatBg(""),$("#js-input-thread-chat-bg").removeClass("zadark-input-file--loaded")}),$("#js-switch-hide-latest-message").on("change",function(){const a=$(this).is(":checked");v(a)}),$("#js-switch-hide-conv-avatar").on("change",function(){const a=$(this).is(":checked");m(a)}),$("#js-switch-hide-conv-name").on("change",function(){const a=$(this).is(":checked");w(a)}),$("#js-switch-hide-thread-chat-message").on("change",function(){const a=$(this).is(":checked");y(a)}),$("#js-switch-block-typing").on("change",i("rules_block_typing")),$("#js-switch-block-seen").on("change",i("rules_block_seen")),$("#js-switch-block-delivered").on("change",i("rules_block_delivered")),$("#js-switch-use-hotkeys").on("change",c);const n=document.querySelector("#js-zadark-popup"),t=document.getElementById("div_Main_TabZaDark");t.addEventListener("click",k(t,n));["click","contextmenu"].forEach(a=>{window.addEventListener(a,((a,n)=>s=>{null!==n.getAttribute("data-visible")&&!n.contains(s.target)&&!a.contains(s.target)&&h(a,n,!1)})(t,n),!0)}),d(),(async()=>{const{useHotkeys:a}=await ZaDarkBrowser.getExtensionSettings();s("#js-switch-use-hotkeys",a),r(a)})(),(async a=>{const{knownVersion:n}=await ZaDarkBrowser.getExtensionSettings();n!==ZaDarkBrowser.getManifest().version&&a.classList.add("zadark-known-version")})(t),o(),$("#js-zadark-popup__scrollable").on("scroll",ZaDarkShared.debounce(o,150)),$(window).on("resize",ZaDarkShared.debounce(o,250)),$("#js-btn-scroll").on("click",a=>{a.stopPropagation(),a.preventDefault(),$("#js-zadark-popup__scrollable").animate({scrollTop:$("#js-zadark-popup__scrollable").height()},1e3)}),(async()=>{const{translateTarget:a}=await ZaDarkBrowser.getExtensionSettings();$("#js-select-translate-target").setLanguagesOptions(a),$(document).enableTranslateMessage(a)})(),ZaDarkUtils.initTippy(),$("[data-zdk-intro]").on("click",function(a){a.preventDefault(),a.stopPropagation();const s=$(this).data("zdk-intro"),e=$("#chatViewContainer").length>0;if(["hideThreadChatMessage"].includes(s)&&!e)return void ZaDarkUtils.showToast("Chọn một cuộc trò chuyện để xem hướng dẫn");h(t,n,!1);const i={onExit:()=>h(t,n,!0),onComplete:()=>h(t,n,!0)};"hideThreadChatMessage"===s&&ZaDarkUtils.showIntroHideThreadChatMessage(i)}),document.addEventListener("@ZaDark:CONV_ID_CHANGE",function(){(async()=>{const a=ZaDarkUtils.getThreadChatBgSettingKey();if(!a)return void ZaDarkUtils.showToast("Không thể tải hình nền vì không xác định được cuộc trò chuyện hiện tại",{className:"toastify--error",duration:3e3});let n=!0;if(!document.getElementById(a)){const s=(await ZaDarkBrowser.getExtensionSettingsLocal({[a]:""}))[a];n=!!s,ZaDarkUtils.refreshThreadChatBg(s)}n?$("#js-input-thread-chat-bg").addClass("zadark-input-file--loaded"):$("#js-input-thread-chat-bg").removeClass("zadark-input-file--loaded")})()})},u=new MutationObserver(a=>{a.forEach(a=>{a.addedNodes.forEach(a=>{"app-page"===a.id&&(p(),u.disconnect())})})});u.observe(document.querySelector("#app"),{subtree:!1,childList:!0});const _=(n="dark")=>{a(n),ZaDarkUtils.updateTheme(n)},b=(a="medium")=>{n("#js-select-font-size",a),ZaDarkUtils.updateFontSize(a)},g=(a="none")=>{n("#js-select-translate-target",a),ZaDarkUtils.updateTranslateTarget(a),$(document).disableTranslateMessage(),"none"!==a&&$(document).enableTranslateMessage(a)},v=a=>{s("#js-switch-hide-latest-message",a),ZaDarkUtils.updateHideLatestMessage(a)},m=a=>{s("#js-switch-hide-conv-avatar",a),ZaDarkUtils.updateHideConvAvatar(a)},w=a=>{s("#js-switch-hide-conv-name",a),ZaDarkUtils.updateHideConvName(a)},y=a=>{s("#js-switch-hide-thread-chat-message",a),ZaDarkUtils.updateHideThreadChatMessage(a)},z=a=>{s("#js-switch-use-hotkeys",a),r(a),ZaDarkUtils.updateUseHotkeys(a)},f=ZaDarkUtils.MSG_ACTIONS;ZaDarkBrowser.addMessageListener((a,n,s)=>{if(a.action===f.CHANGE_THEME){const{theme:n}=a.payload;_(n),s({received:!0})}if(a.action===f.CHANGE_FONT_SIZE){const{fontSize:n}=a.payload;b(n),s({received:!0})}if(a.action===f.CHANGE_TRANSLATE_TARGET){const{translateTarget:n}=a.payload;g(n),s({received:!0})}if(a.action===f.CHANGE_HIDE_LATEST_MESSAGE){const{isEnabled:n}=a.payload;v(n),s({received:!0})}if(a.action===f.CHANGE_HIDE_CONV_AVATAR){const{isEnabled:n}=a.payload;m(n),s({received:!0})}if(a.action===f.CHANGE_HIDE_CONV_NAME){const{isEnabled:n}=a.payload;w(n),s({received:!0})}if(a.action===f.CHANGE_HIDE_THREAD_CHAT_MESSAGE){const{isEnabled:n}=a.payload;y(n),s({received:!0})}if(a.action===f.CHANGE_USE_HOTKEYS){const{isEnabled:n}=a.payload;z(n),s({received:!0})}a.action===f.REFRESH_ZALO_TABS&&(window.location.reload(),s({received:!0})),"ncdai"===a.action&&(console.log("conv",a.payload),s({received:!0}))})}();